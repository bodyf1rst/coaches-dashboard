<div class="video-library-container">
  <div class="header-section">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="page-title">All Exercises ({{filteredVideos.length}})</h1>
      <div class="header-actions">
        <input type="text"
               class="search-input"
               placeholder="Search here..."
               [(ngModel)]="searchText"
               (ngModelChange)="searchVideos()">
        <button class="btn btn-add">Add Exercise</button>
        <button class="btn btn-filter">Filter</button>
      </div>
    </div>
  </div>

  <div class="exercise-grid" *ngIf="!loading">
    <div class="exercise-card" *ngFor="let video of filteredVideos" (click)="playVideo(video)">
      <div class="video-thumbnail">
        <div class="thumbnail-gradient" [style.display]="video.thumbnailError ? 'flex' : 'none'">
          <i class="fas fa-play play-icon"></i>
        </div>
        <img *ngIf="!video.thumbnailError"
             [src]="video.thumbnailUrl"
             [alt]="video.video_title"
             (error)="handleThumbnailError(video, $event)"
             class="thumbnail-img">
        <span class="duration-badge">{{video.duration || '0:00'}}</span>
      </div>
      <div class="video-info">
        <h3 class="video-title">{{video.video_title}}</h3>
        <div class="video-tags">
          <span class="tag category" *ngIf="video.category">{{video.category}}</span>
          <span class="tag type" *ngFor="let tag of video.tags || []">{{tag}}</span>
        </div>
        <div class="video-status">
          <span class="status-badge active" *ngIf="video.is_active">Active</span>
          <span class="status-badge public">Public</span>
        </div>
      </div>
    </div>
  </div>

  <div class="text-center py-5" *ngIf="loading">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div class="text-center py-5" *ngIf="!loading && filteredVideos.length === 0">
    <p>No videos found matching your search criteria.</p>
  </div>
</div>

<!-- Video Player Modal -->
<div class="video-modal-overlay" *ngIf="showVideoModal" (click)="closeVideoModal()">
  <div class="video-modal-content" (click)="$event.stopPropagation()">
    <button class="modal-close-btn" (click)="closeVideoModal()">
      <i class="fas fa-times"></i>
    </button>

    <div class="modal-header">
      <h2>{{selectedVideo?.video_title}}</h2>
    </div>

    <div class="modal-body">
      <div class="video-player-wrapper">
        <video
          *ngIf="selectedVideo?.video_url"
          [src]="selectedVideo.video_url"
          controls
          autoplay
          class="video-player">
          Your browser does not support the video tag.
        </video>
      </div>

      <div class="video-details">
        <div class="video-meta">
          <span class="badge category-badge">{{selectedVideo?.category}}</span>
          <span class="badge duration-badge">{{selectedVideo?.duration}}</span>
        </div>

        <div class="video-tags" *ngIf="selectedVideo?.tags?.length">
          <span class="tag" *ngFor="let tag of selectedVideo.tags">{{tag}}</span>
        </div>

        <div class="video-transcription" *ngIf="selectedVideo?.transcription">
          <h4>Transcription</h4>
          <p>{{selectedVideo.transcription}}</p>
        </div>

        <div class="no-transcription" *ngIf="!selectedVideo?.transcription">
          <p class="text-muted"><i class="fas fa-info-circle"></i> No transcription available for this video</p>
        </div>
      </div>
    </div>
  </div>
</div>
