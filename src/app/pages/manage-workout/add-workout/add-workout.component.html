<div class="main-dashboard-area">
  <div class="dashboard-left">
    <app-left-sidebar></app-left-sidebar>
  </div>
  <div class="dashboard-right">
    <div class="dashboard-right-head">
      <div class="dashboard-right-head-left">
        <div class="backIcon static">
          <button (click)="goBack()"><i class="fa-solid fa-arrow-left"></i></button>
        </div>
        <h1 class="mb-md-0 ct">{{workoutId?'Workout Details':'Build Workout'}}</h1>
      </div>
      <!-- <button
        *ngIf="
        workoutData?.id && dataService.currentUserData.role != 'Admin' && (dataService?.currentUserData?.id != workoutData?.uploaded_by || dataService.currentUserData.role != workoutData?.uploader)"
        class="btn btn-primary ml-auto" (click)="cloneItem(workoutId,'workout')"
        [disabled]="dataService.isLoading">Clone Workout</button> -->
      <div class="dashboard-right-head-right"
        *ngIf="dataService?.currentUserData?.role == 'Admin' || (dataService?.currentUserData?.id == workoutData?.uploaded_by && dataService?.currentUserData?.role == workoutData?.uploader)">
        <!-- <button
          *ngIf="workoutData?.id && (dataService?.currentUserData?.id != workoutData?.uploaded_by || dataService.currentUserData.role != workoutData?.uploader)"
          class="btn btn-primary" (click)="cloneItem(workoutId,'workout')" [disabled]="dataService.isLoading">Clone
          Workout</button> -->
        <button *ngIf="workoutData?.id" class="btn btn-p" [ngClass]="workoutData?.is_active?'btn-success':'btn-danger'"
          data-bs-toggle="modal" data-bs-target="#actionModal" data-bs-title="Click for change Status"
          appTooltip>{{workoutData?.is_active?'Active':'Blocked'}}</button>
        <button (click)="checkDeletion()" *ngIf="workoutId" type="submit" class="filter-btn" style="background: red;"
          data-bs-toggle="modal" data-bs-target="#dModal" data-bs-title="Delete Workout" appTooltip><i
            class="fa-solid fa-trash-can" style="color: #fff;"></i></button>
        <button type="submit" class="filter-btn" data-bs-toggle="tooltip" data-bs-title="Edit Workout"
          *ngIf="workoutId && !isEdit && dataService?.currentUserData?.id == workoutData?.uploaded_by && dataService.currentUserData.role == workoutData?.uploader"
          (click)="onEdit()"><i class="fa-solid fa-pencil"></i></button>
        <button type="submit" class="filter-btn w-auto btn-p" data-bs-toggle="tooltip" data-bs-title="Cancel Edit"
          *ngIf="workoutId && isEdit" (click)="onEdit()">Cancel Edit</button>
      </div>
    </div>
    <div class="dashboard-content">
      <div class="ssw">
        We recommend to viewing this screen in tablet or web view for the best experience
      </div>
      <div class="workout-build-area">
        <div #scrollContainer class="workout-bild-left">
          <div class="row p-2" novalidate>
            <div class="col-md-6 col-12 mb-1">
              <input [readonly]="!isEdit && workoutId" class="form-control" placeholder="Enter Workout Title*"
                [(ngModel)]="workoutData.title"
                [class.is-invalid]="isSubmitted && (!workoutData.title || workoutData?.title?.length < 5 || workoutData?.title?.length > 100)" />
              <div class="text-start text-danger mt-1" style="font-size: 14px"
                *ngIf="isSubmitted && workoutData?.title?.length < 5">Minimum length should
                be greater then 4.</div>
              <div class="text-start text-danger mt-1" style="font-size: 14px"
                *ngIf="isSubmitted && workoutData?.title?.length > 100">Maximum length should not
                be greater then 100.</div>
            </div>
            <div class="col-md-6 col-12 mb-1">
              <select class="form-select" [(ngModel)]="workoutData.visibility_type"
                [attr.disabled]="!isEdit ? true : null" required
                [class.is-invalid]="isSubmitted && !workoutData.visibility_type">
                <option selected [ngValue]="null">
                  Select
                  Visibility</option>
                <option value="Public">Public</option>
                <option value="Private">Private</option>
              </select>
            </div>
          </div>
          <div class="workout-bild-left-top" *ngIf="workoutData?.exercises?.length && (!workoutId  || isEdit)">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" [(ngModel)]="selectAll" (change)="toggleAllCheckboxes()"
                id="flexCheckDefault">
            </div>
            <button *ngIf="isSupersetSelected()" type="button" class="btn btn-light"
              (click)="deleteSelectedSupersets()">
              <i class="fa-solid fa-trash"></i>
              Break Superset
            </button>
            <button *ngIf="!isAnyItemSelected()" type="button" class="btn btn-light" (click)="addRest()"><i
                class="fa-solid fa-plus"></i> Add
              Rest</button>
            <button *ngIf="isAnyItemSelected()" type="button" class="btn btn-light" (click)="makeSet()"><i
                class="fa-solid fa-plus"></i>
              Superset</button>
            <button *ngIf="isAnyItemSelected()" type="button" class="btn btn-danger del"
              (click)="deleteSelectedExercises()"><i class="fa-solid fa-trash-can"></i></button>
          </div>
          <div class="workout-bild-left-tablist" *ngIf="isEdit">
            <div class="text-center" *ngIf="!workoutData?.exercises?.length">
              Exercises not Selected!
            </div>

            <!-- Main Exercise List with Dragula -->
            <div [dragula]="'mainGroup'" [dragulaModel]="workoutData?.exercises"
              (dragulaModelChange)="listSorted($event, 'main')">

              <!-- Loop through main exercises -->
              <div class="sortable-list-item" *ngFor="let item of workoutData?.exercises; index as i">

                <!-- Superset Block -->
                <div class="superset-tab" *ngIf="item?.superset?.length">
                  <h6 style="display: flex; align-items: center;">
                    <div class="form-check" *ngIf="!workoutId || isEdit">
                      <input class="form-check-input" type="checkbox" [(ngModel)]="item.selected"
                        (change)="updateSelectAllState()" [id]="'flexCheckDefault'+i">
                    </div>
                    Superset <span class="handle">&#8942;&#8942;</span>
                  </h6>

                  <!-- Sub Dragula Container for Superset -->
                  <div [dragula]="'subGroup_'+i" [dragulaModel]="item?.superset"
                    (dragulaModelChange)="listSorted($event, i)">
                    <div *ngFor="let set of item?.superset; index as s" class="workout-list-tab-area"
                      [class.rest]="set.is_rest">
                      <div class="workout-list-tab">
                        <!-- Superset Block Content -->
                        <div class="d-flex align-items-center gap-2">
                          <div class="workout-list-tab-img">
                            <img
                              [src]="(set?.videos?.length > 0 && set?.videos[0]?.video_thumbnail) ? set?.videos[0]?.video_thumbnail : '../../../../assets/images/default-thumbnail.jpg'"
                              class="img-fluid" *ngIf="!set.is_rest" />
                            <span *ngIf="set.is_rest">R</span>
                          </div>
                          <h6>{{ set?.title || 'Rest' }}</h6>
                        </div>
                        <!-- Duration / Sets Selectors -->
                        <div class="workout-list-tab-duration">
                          <div class="form-check" style="position: relative; margin-bottom: 0;" *ngIf="!set.is_rest">
                            <input class="form-check-input" type="checkbox" value=""
                              [id]="'stagflexCheckDefaultSuperset' + s" [(ngModel)]="set.is_stag"
                              (change)="updateRepsArray(i, set)">
                            <label class="form-check-label" style="margin-bottom: 0;"
                              [for]="'stagflexCheckDefaultSuperset' + s">
                              Stag
                            </label>
                          </div>
                          <select class="form-select conditional" [(ngModel)]="set.type" *ngIf="!set.is_rest"
                            [disabled]="!isEdit" (change)="updateRepsArray(i, set)">
                            <option [value]="'Duration'">Duration</option>
                            <option [value]="'Sets'">Rep/Sets</option>
                          </select>

                          <!-- Duration Inputs for Superset -->
                          <div class="duration" *ngIf="set.type == 'Duration'">
                            <div class="duration" *ngIf="set.is_stag">
                              <!-- Select number of sets for Superset Duration -->
                              <select class="form-control" [(ngModel)]="set.set" (change)="updateRepsArray(i, set)"
                                [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !set.disabled && !set.set">
                                <option [ngValue]="null">Sets</option>
                                <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                              </select>

                              <!-- Dynamically generate min/sec inputs based on the number of sets -->
                              <div class="duration-time">
                                <div class="duration" *ngFor="let ra of set.repsArray; let idx = index">
                                  <!-- Duration inputs for each set -->
                                  <select class="form-control" [(ngModel)]="ra.min" [disabled]="!isEdit"
                                    [class.is-invalid]="isSubmitted && !set.disabled && !ra.min && !ra.sec">
                                    <option [ngValue]="null">Min</option>
                                    <option [value]="min" *ngFor="let min of timeArray">{{ min }} min</option>
                                  </select>
                                  <select class="form-control" [(ngModel)]="ra.sec" [disabled]="!isEdit"
                                    [class.is-invalid]="isSubmitted && !set.disabled && !ra.min && !ra.sec">
                                    <option [ngValue]="null">Sec</option>
                                    <option [value]="sec" *ngFor="let sec of timeArray">{{ sec }} sec</option>
                                  </select>
                                </div>
                              </div>
                            </div>

                            <!-- Regular Duration Inputs for Superset without Stag -->
                            <div class="duration" *ngIf="!set.is_stag">
                              <select class="form-control" [(ngModel)]="set.min" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.min && !set.sec">
                                <option [ngValue]="null">Min</option>
                                <option [value]="min" *ngFor="let min of timeArray">{{ min }} min</option>
                              </select>
                              <select class="form-control" [(ngModel)]="set.sec" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.min && !set.sec">
                                <option [ngValue]="null">Sec</option>
                                <option [value]="sec" *ngFor="let sec of timeArray">{{ sec }} sec</option>
                              </select>
                            </div>
                          </div>

                          <!-- Sets/Rep Inputs for Superset -->
                          <div *ngIf="set.type == 'Sets'">
                            <div class="duration" *ngIf="set.is_stag">
                              <!-- Select number of sets -->
                              <select class="form-control" [(ngModel)]="set.set" (change)="updateRepsArray(i, set)"
                                [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !set.disabled && !set.set">
                                <option [ngValue]="null">Sets</option>
                                <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                              </select>

                              <div class="multi-rep">
                                <!-- Dynamically generate reps based on the number of sets for Superset -->
                                <div *ngFor="let ra of set.repsArray; let idx = index">
                                  <select class="form-control" [(ngModel)]="ra.rep" [disabled]="!isEdit"
                                    [class.is-invalid]="isSubmitted && !set.disabled && !ra.rep">
                                    <option [ngValue]="null">Rep</option>
                                    <option [value]="rep" *ngFor="let rep of setArray">{{ rep }} reps</option>
                                  </select>
                                </div>
                              </div>
                            </div>

                            <div class="duration" *ngIf="!set.is_stag">
                              <!-- Regular Sets/Rep Inputs for Superset without Stag -->
                              <select class="form-control" [(ngModel)]="set.set" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.set">
                                <option [ngValue]="null">Sets</option>
                                <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                              </select>
                              <select class="form-control" [(ngModel)]="set.rep" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.rep">
                                <option [ngValue]="null">Rep</option>
                                <option [value]="rep" *ngFor="let rep of setArray">{{ rep }} reps</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <span class="handle2">&#8942;&#8942;</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Normal Exercise Block (Non-Superset) -->
                <div class="workout-list-tab-area" [class.rest]="item.is_rest" *ngIf="!item?.superset?.length">
                  <div class="form-check" *ngIf="!workoutId || isEdit">
                    <input class="form-check-input" type="checkbox" [(ngModel)]="item.selected"
                      [id]="'flexCheckDefault' + i">
                  </div>
                  <div class="workout-list-tab" [class.rest]="item.is_rest">
                    <div class="d-flex align-items-center gap-2">
                      <div class="workout-list-tab-img">
                        <img
                          [src]="(item?.videos?.length > 0 && item?.videos[0]?.video_thumbnail) ? item?.videos[0]?.video_thumbnail : '../../../../assets/images/default-thumbnail.jpg'"
                          class="img-fluid" *ngIf="!item.is_rest" />
                        <span *ngIf="item.is_rest">R</span>
                      </div>
                      <h6>{{ item?.title || 'Rest' }}</h6>
                    </div>

                    <!-- Duration / Sets Selectors -->
                    <div class="workout-list-tab-duration">
                      <div class="form-check" style="position: relative; margin-bottom: 0;" *ngIf="!item.is_rest">
                        <input class="form-check-input" type="checkbox" value="" [id]="'stagflexCheckDefault' + i"
                          [(ngModel)]="item.is_stag" (change)="updateRepsArray(i, item)">
                        <label class="form-check-label" style="margin-bottom: 0;" [for]="'stagflexCheckDefault' + i">
                          Stag
                        </label>
                      </div>
                      <select class="form-select conditional" [(ngModel)]="item.type" *ngIf="!item.is_rest"
                        [disabled]="!isEdit" (change)="updateRepsArray(i, item)">
                        <option [value]="'Duration'">Duration</option>
                        <option [value]="'Sets'">Rep/Sets</option>
                      </select>

                      <!-- Duration Inputs for Regular Exercise -->
                      <div class="duration" *ngIf="item.type == 'Duration'">
                        <div class="duration" *ngIf="item.is_stag">
                          <select class="form-control" [(ngModel)]="item.set" (change)="updateRepsArray(i, item)"
                            [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !item.disabled && !item.set">
                            <option [ngValue]="null">Sets</option>
                            <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                          </select>

                          <div class="duration-time">
                            <div class="duration" *ngFor="let ra of item.repsArray; let idx = index">
                              <select class="form-control" [(ngModel)]="ra.min" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !item.disabled && !ra.min && !ra.sec">
                                <option [ngValue]="null">Min</option>
                                <option [value]="min" *ngFor="let min of timeArray">{{ min }} min</option>
                              </select>
                              <select class="form-control" [(ngModel)]="ra.sec" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !item.disabled && !ra.min && !ra.sec">
                                <option [ngValue]="null">Sec</option>
                                <option [value]="sec" *ngFor="let sec of timeArray">{{ sec }} sec</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <!-- Regular Duration Inputs for Non-Superset Exercise -->
                        <div class="duration" *ngIf="!item.is_stag">
                          <select class="form-control" [(ngModel)]="item.min" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.min && !item.sec">
                            <option [ngValue]="null">Min</option>
                            <option [value]="min" *ngFor="let min of timeArray">{{ min }} min</option>
                          </select>
                          <select class="form-control" [(ngModel)]="item.sec" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.min && !item.sec">
                            <option [ngValue]="null">Sec</option>
                            <option [value]="sec" *ngFor="let sec of timeArray">{{ sec }} sec</option>
                          </select>
                        </div>
                      </div>

                      <!-- Sets/Rep Inputs for Regular Exercise -->
                      <div *ngIf="item.type == 'Sets'">
                        <div class="duration" *ngIf="item.is_stag">
                          <select class="form-control" [(ngModel)]="item.set" (change)="updateRepsArray(i, item)"
                            [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !item.disabled && !item.set">
                            <option [ngValue]="null">Sets</option>
                            <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                          </select>

                          <div class="multi-rep">
                            <div *ngFor="let ra of item.repsArray; let idx = index">
                              <select class="form-control" [(ngModel)]="ra.rep" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !item.disabled && !ra.rep">
                                <option [ngValue]="null">Rep</option>
                                <option [value]="rep" *ngFor="let rep of setArray">{{ rep }} reps</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <div class="duration" *ngIf="!item.is_stag">
                          <select class="form-control" [(ngModel)]="item.set" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.set">
                            <option [ngValue]="null">Sets</option>
                            <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                          </select>
                          <select class="form-control" [(ngModel)]="item.rep" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.rep">
                            <option [ngValue]="null">Rep</option>
                            <option [value]="rep" *ngFor="let rep of setArray">{{ rep }} reps</option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <span class="handle">&#8942;&#8942;</span>
                  </div>
                </div>

              </div>
            </div>

          </div>



          <div class="workout-bild-left-tablist" *ngIf="!isEdit && workoutId">
            <div class="text-center" *ngIf="!workoutData?.exercises?.length">Exercises not Selected!</div>
            <div *ngIf="workoutData?.exercises?.length">

              <!-- Loop through main exercises -->
              <div class="sortable-list-item"
                *ngFor="let item of workoutData?.exercises; index as i; trackBy: trackByFn">

                <!-- Superset Block -->
                <div class="superset-tab" *ngIf="item?.superset?.length">
                  <h6 style="display: flex; align-items: center;">
                    <div class="form-check" *ngIf="!workoutId || isEdit">
                      <input class="form-check-input" type="checkbox" [(ngModel)]="item.selected"
                        (change)="updateSelectAllState()" [id]="'flexCheckDefault'+i">
                    </div>
                    Superset
                  </h6>
                  <div>
                    <div *ngFor="let set of item?.superset; index as s; trackBy: trackByFn"
                      class="workout-list-tab-area" [class.rest]="set.is_rest">

                      <!-- Superset Item (Exercise/Rest) -->
                      <div class="workout-list-tab" (click)="onClickExercise(set, i, s)"
                        [class.clicked]="!isEdit && s === selectedSupersetIndex && i == selectedIndex">
                        <!-- Superset Block Content -->
                        <div class="d-flex align-items-center gap-2">
                          <div class="workout-list-tab-img">
                            <img
                              [src]="(set?.videos?.length > 0 && set?.videos[0]?.video_thumbnail) ? set?.videos[0]?.video_thumbnail : '../../../../assets/images/default-thumbnail.jpg'"
                              class="img-fluid" *ngIf="!set.is_rest" />
                            <span *ngIf="set.is_rest">R</span>
                          </div>
                          <h6>{{ set?.title || 'Rest' }}</h6>
                        </div>
                        <!-- Duration / Sets Selectors -->
                        <div class="workout-list-tab-duration">
                          <select class="form-select conditional" [(ngModel)]="set.type" *ngIf="!set.is_rest"
                            [disabled]="!isEdit" (change)="updateRepsArray(i, set)">
                            <option [value]="'Duration'">Duration</option>
                            <option [value]="'Sets'">Rep/Sets</option>
                          </select>

                          <!-- Duration Inputs for Superset -->
                          <div class="duration" *ngIf="set.type == 'Duration'">
                            <div class="duration" *ngIf="set.is_stag">
                              <!-- Select number of sets for Superset Duration -->
                              <select class="form-control" [(ngModel)]="set.set" (change)="updateRepsArray(i, set)"
                                [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !set.disabled && !set.set">
                                <option [ngValue]="null">Sets</option>
                                <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                              </select>

                              <!-- Dynamically generate min/sec inputs based on the number of sets -->
                              <div class="duration-time">
                                <div class="duration" *ngFor="let ra of set.repsArray; let idx = index">
                                  <!-- Duration inputs for each set -->
                                  <select class="form-control" [(ngModel)]="ra.min" [disabled]="!isEdit"
                                    [class.is-invalid]="isSubmitted && !set.disabled && !ra.min && !ra.sec">
                                    <option [ngValue]="null">Min</option>
                                    <option [value]="min" *ngFor="let min of timeArray">{{ min }} min</option>
                                  </select>
                                  <select class="form-control" [(ngModel)]="ra.sec" [disabled]="!isEdit"
                                    [class.is-invalid]="isSubmitted && !set.disabled && !ra.min && !ra.sec">
                                    <option [ngValue]="null">Sec</option>
                                    <option [value]="sec" *ngFor="let sec of timeArray">{{ sec }} sec</option>
                                  </select>
                                </div>
                              </div>
                            </div>

                            <!-- Regular Duration Inputs for Superset without Stag -->
                            <div class="duration" *ngIf="!set.is_stag">
                              <select class="form-control" [(ngModel)]="set.min" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.min && !set.sec">
                                <option [ngValue]="null">Min</option>
                                <option [value]="min" *ngFor="let min of timeArray">{{ min }} min</option>
                              </select>
                              <select class="form-control" [(ngModel)]="set.sec" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.min && !set.sec">
                                <option [ngValue]="null">Sec</option>
                                <option [value]="sec" *ngFor="let sec of timeArray">{{ sec }} sec</option>
                              </select>
                            </div>
                          </div>

                          <!-- Sets/Rep Inputs for Superset -->
                          <div *ngIf="set.type == 'Sets'">
                            <div class="duration" *ngIf="set.is_stag">
                              <!-- Select number of sets -->
                              <select class="form-control" [(ngModel)]="set.set" (change)="updateRepsArray(i, set)"
                                [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !set.disabled && !set.set">
                                <option [ngValue]="null">Sets</option>
                                <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                              </select>

                              <div class="multi-rep">
                                <!-- Dynamically generate reps based on the number of sets for Superset -->
                                <div *ngFor="let ra of set.repsArray; let idx = index">
                                  <select class="form-control" [(ngModel)]="ra.rep" [disabled]="!isEdit"
                                    [class.is-invalid]="isSubmitted && !set.disabled && !ra.rep">
                                    <option [ngValue]="null">Rep</option>
                                    <option [value]="rep" *ngFor="let rep of setArray">{{ rep }} reps</option>
                                  </select>
                                </div>
                              </div>
                            </div>

                            <div class="duration" *ngIf="!set.is_stag">
                              <!-- Regular Sets/Rep Inputs for Superset without Stag -->
                              <select class="form-control" [(ngModel)]="set.set" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.set">
                                <option [ngValue]="null">Sets</option>
                                <option [value]="i" *ngFor="let i of setArray">{{ i }} sets</option>
                              </select>
                              <select class="form-control" [(ngModel)]="set.rep" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !set.disabled && !set.rep">
                                <option [ngValue]="null">Rep</option>
                                <option [value]="rep" *ngFor="let rep of setArray">{{ rep }} reps</option>
                              </select>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Normal Exercise Block (Non-Superset) -->
                <div class="workout-list-tab-area" [class.rest]="item.is_rest" *ngIf="!item?.superset?.length">
                  <div class="form-check" *ngIf="!workoutId || isEdit">
                    <input class="form-check-input" type="checkbox" [(ngModel)]="item.selected"
                      (change)="updateSelectAllState()" [id]="'flexCheckDefault'+i">
                  </div>
                  <div class="workout-list-tab" (click)="onClickExercise(item, i)"
                    [class.clicked]="!isEdit && i === selectedIndex">
                    <div class="d-flex align-items-center gap-2">
                      <div class="workout-list-tab-img">
                        <img
                          [src]="(item?.videos?.length > 0 && item?.videos[0]?.video_thumbnail) ? item?.videos[0]?.video_thumbnail : '../../../../assets/images/default-thumbnail.jpg'"
                          class="img-fluid" *ngIf="!item.is_rest" />
                        <span *ngIf="item.is_rest">R</span>
                      </div>
                      <h6>{{ item?.title || 'Rest' }}</h6>
                    </div>

                    <!-- Duration / Sets Selectors -->
                    <div class="workout-list-tab-duration">
                      <select class="form-select conditional" [(ngModel)]="item.type" *ngIf="!item.is_rest"
                        [disabled]="!isEdit">
                        <option [value]="'Duration'">Duration</option>
                        <option [value]="'Sets'">Sets/Rep</option>
                      </select>

                      <!-- Duration Inputs -->
                      <div class="duration" *ngIf="item.type == 'Duration'">
                        <div class="duration" *ngIf="item.is_stag">
                          <!-- Select number of sets for Duration -->
                          <select class="form-control" [(ngModel)]="item.set" (change)="updateRepsArray(i, item)"
                            [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !item.disabled && !item.set">
                            <option [ngValue]="null">Sets</option>
                            <option [value]="i" *ngFor="let i of setArray">{{i}} sets</option>
                          </select>

                          <!-- Dynamically generate min/sec inputs based on the number of sets -->
                          <div class="duration-time">
                            <div class="duration" *ngFor="let ra of item.repsArray; let idx = index">
                              <!-- Duration inputs for each set -->
                              <select class="form-control" [(ngModel)]="ra.min" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !item.disabled && !ra.min && !ra.sec">
                                <option [ngValue]="null">Min</option>
                                <option [value]="min" *ngFor="let min of timeArray">{{min}} min</option>
                              </select>
                              <select class="form-control" [(ngModel)]="ra.sec" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !item.disabled && !ra.min && !ra.sec">
                                <option [ngValue]="null">Sec</option>
                                <option [value]="sec" *ngFor="let sec of timeArray">{{sec}} sec</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <!-- Regular Duration Inputs without Stag -->
                        <div class="duration" *ngIf="!item.is_stag">
                          <select class="form-control" [(ngModel)]="item.min" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.min && !item.sec">
                            <option [ngValue]="null">Min</option>
                            <option [value]="min" *ngFor="let min of timeArray">{{min}} min</option>
                          </select>
                          <select class="form-control" [(ngModel)]="item.sec" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.min && !item.sec">
                            <option [ngValue]="null">Sec</option>
                            <option [value]="sec" *ngFor="let sec of timeArray">{{sec}} sec</option>
                          </select>
                        </div>
                      </div>

                      <!-- Sets/Rep Inputs -->
                      <div *ngIf="item.type == 'Sets'">
                        <div class="duration" *ngIf="item.is_stag">
                          <!-- Select number of sets -->
                          <select class="form-control" [(ngModel)]="item.set" (change)="updateRepsArray(i, item)"
                            [disabled]="!isEdit" [class.is-invalid]="isSubmitted && !item.disabled && !item.set">
                            <option [ngValue]="null">Sets</option>
                            <option [value]="i" *ngFor="let i of setArray">{{i}} sets</option>
                          </select>

                          <div class="multi-rep">
                            <!-- Dynamically generate reps based on the number of sets -->
                            <div *ngFor="let ra of item.repsArray; let idx = index">
                              <select class="form-control" [(ngModel)]="ra.rep" [disabled]="!isEdit"
                                [class.is-invalid]="isSubmitted && !item.disabled && !ra.rep">
                                <option [ngValue]="null">Rep</option>
                                <option [value]="rep" *ngFor="let rep of setArray">{{rep}} reps</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <div class="duration" *ngIf="!item.is_stag">
                          <!-- Regular Sets/Rep Inputs without Stag -->
                          <select class="form-control" [(ngModel)]="item.set" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.set">
                            <option [ngValue]="null">Sets</option>
                            <option [value]="i" *ngFor="let i of setArray">{{i}} sets</option>
                          </select>
                          <select class="form-control" [(ngModel)]="item.rep" [disabled]="!isEdit"
                            [class.is-invalid]="isSubmitted && !item.disabled && !item.rep">
                            <option [ngValue]="null">Rep</option>
                            <option [value]="rep" *ngFor="let rep of setArray">{{rep}} reps</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="workout-build-bottom" *ngIf="workoutData?.exercises?.length">
            <button *ngIf="!workoutId || isEdit" type="submit"
              class="btn btn-primary w-100 d-flex justify-content-center align-items-center gap-2 m-auto"
              [disabled]="dataService.isLoading" (click)="onSubmitForm()">
              {{workoutId ? 'Update':'Create'}} Workout <div class="spinner-border text-light" role="status"
                *ngIf="dataService.isLoading">
                <span class="visually-hidden">Loading...</span>
              </div>
            </button>
          </div>
        </div>
        <div class="workout-bild-right">
          <div class="workout-bild-right-top" *ngIf="!workoutId  || isEdit">
            <div class="search-filter">
              <div class="tagfilter">
                <select class="form-select" [(ngModel)]="pageFilter.tag" (change)="onSearch()">
                  <option value="">Search By Tags</option>
                  <option [value]="item.tag" *ngFor="let item of dataService.tagsDropdown">{{item.tag}}</option>
                </select>
              </div>
              <div class="search-container">
                <input type="text" placeholder="Search here.." name="search" class="form-control" spellcheck="true"
                  [(ngModel)]="fieldText" (keydown.enter)="onSearch()">
                <button type="submit">
                  <div class="d-block spinner-border text-light" role="status" *ngIf="dataService.isLoading">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                  <i class="fa-solid fa-magnifying-glass" *ngIf="!dataService.isLoading && !isSearched"
                    (click)="onSearch()"></i>
                  <i class="fa-regular fa-circle-xmark" *ngIf="!dataService.isLoading && isSearched"
                    (click)="clearSearch()"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="workout-videos" *ngIf="isEdit">
            <div class="d-block spinner-border text-dark m-auto mb-2" role="status"
              *ngIf="dataService.isLoading && !dataService?.exercisesList.exercises?.length">
              <span class="visually-hidden">Loading...</span>
            </div>
            <div class="text-center" *ngIf="!dataService.isLoading && !dataService?.exercisesList.exercises?.length">
              Data not
              found.</div>
            <div class="vidoes-listing" *ngIf="dataService?.exercisesList.exercises?.length">
              <div class="row">
                <div class="col-xl-4 col-sm-6" *ngFor="let item of dataService.exercisesList.exercises; index as i">
                  <div *ngIf="item?.videos?.length" class="main-tab small"
                    [ngClass]="item?.videoPlaying ? 'videoplaying' : ''"
                    [class.selected]="selectedItem?.id == item?.id">
                    <div class="main-tab-top">
                      <div class="indication">
                        <span><i class="fa-solid fa-plus" (click)="toggleVideoSelection(item)"></i></span>
                      </div>
                    </div>
                    <img *ngIf="!item.videos[0].video_file && item.videos[0].video_url" class="img-fluid w-100"
                      [src]="item?.videos[0].video_thumbnail ? item?.videos[0].video_thumbnail : '..//../../../assets/images/default-thumbnail.jpg'">
                    <video #videoPlayerRef [controls]="item.videoPlaying ? true : false" disablepictureinpicture
                      controlslist="nodownload noplaybackrate" class="video modal-video" width="100%" [poster]="item?.videos[0]
.video_thumbnail ? item?.videos[0]
.video_thumbnail : '../../../../assets/images/default-thumbnail.jpg'" id="video-{{item.videos[0].id}}"
                      (click)="onVideoClick(item, $event)">
                      <source [src]="item?.videos[0]?.video_file" type="video/mp4" />
                    </video>
                    <div class="video-play-btn" (click)="toggleVideo(item, videoPlayerRef, $event)">
                      <span *ngIf="!item.videoPlaying"><i class="fa-solid fa-play"></i></span>
                      <span *ngIf="item.videoPlaying"><i class="fa-solid fa-pause"></i></span>
                    </div>
                    <div class="main-tab-text" *ngIf="!item.videoPlaying">{{item?.title}}
                      <span class="catName" *ngIf="item.tags?.length">
                        <small *ngFor="let tag of item.tags.length > 3 ? item.tags.slice(0, 3) : item.tags">
                          #{{ tag }}
                        </small>
                        <small *ngIf="item.tags.length > 3"> +{{ item.tags.length - 3 }}</small>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
              <button [disabled]="dataService.isLoading"
                *ngIf="dataService?.exercisesList?.exercises?.length && dataService?.exercisesList?.exercises?.length < dataService.exercisesList.total_page && (dataService.exercisesList.page != dataService.exercisesList.total_page)"
                class="btn btn-primary btn-p d-flex align-items-center gap-2 m-auto"
                (click)="dataService.fetchData(dataService.exercisesList.page + 1,dataService.httpService.getExercisesApi, 'exercises', 'exercisesList')">Load
                More <div class="spinner-border text-light" role="status" *ngIf="dataService.isLoading">
                  <span class="visually-hidden">Loading...</span>
                </div></button>
            </div>
          </div>
          <div *ngFor="let item of workoutData?.exercises; index as j">
            <div class="workout-videos"
              *ngIf="workoutId && !isEdit && selectedItem?.videos?.length && selectedIndex == j">
              <div class="vidoes-listing">
                <div class="row">
                  <div class="col-md-6 offset-md-3">
                    <div class="main-tab small" [ngClass]="selectedItem.videoPlaying ? 'videoplaying' : ''">
                      <video #videoPlayerRef [controls]="selectedItem.videoPlaying" disablepictureinpicture
                        controlslist="nodownload noplaybackrate" class="video modal-video" width="100%"
                        [poster]="selectedItem.videos[0]?.video_thumbnail ? selectedItem.videos[0]?.video_thumbnail : '../../../../assets/images/default-thumbnail.jpg'"
                        id="video-{{selectedItem.videos[0]?.id}}" (click)="onVideoClick(selectedItem, $event)">
                        <source [src]="selectedItem.videos[0]?.video_file" type="video/mp4" />
                      </video>
                      <div class="video-play-btn" (click)="toggleVideo(selectedItem, videoPlayerRef, $event)">
                        <span *ngIf="!selectedItem.videoPlaying"><i class="fa-solid fa-play"></i></span>
                        <span *ngIf="selectedItem.videoPlaying"><i class="fa-solid fa-pause"></i></span>
                      </div>
                      <div class="main-tab-text" *ngIf="!selectedItem.videoPlaying">{{selectedItem?.title}}
                        <span class="catName" *ngIf="selectedItem.videos[0].tags?.length">
                          <small
                            *ngFor="let tag of selectedItem.videos[0].tags.length > 3 ? selectedItem.videos[0].tags.slice(0, 3) : selectedItem.videos[0].tags">
                            #{{ tag }}
                          </small>
                          <small *ngIf="selectedItem.videos[0].tags.length > 3"> +{{
                            selectedItem.videos[0].tags.length
                            -
                            3 }}</small>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Action Modal -->
<div class="modal fade" data-bs-backdrop="static" id="actionModal" tabindex="-1" aria-labelledby="actionModal"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <button id="closeActionModal" type="button" class="btn-close" data-bs-dismiss="modal"
          aria-label="Close"></button>
      </div>
      <div class="modal-body short-modal">
        <p><img class="modal-img img-fluid"
            [src]="workoutData?.is_active?'../../../../assets/images/deactivate-shop.png':'../../../../assets/images/activate-shop.png'" />
        </p>
        <h5 class="modal-title fs-5 mb-2">{{workoutData?.is_active?'Block':'Activate'}} Workout</h5>
        Do you really want to <strong
          [ngClass]="workoutData?.is_active?'text-danger':'text-success'">{{workoutData?.is_active?'Block':'Activate'}}</strong>
        this
        Workout
        <strong>{{workoutData?.title}}</strong>?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="submit" class="btn w-100 d-flex justify-content-center align-items-center gap-2 m-auto"
          [disabled]="dataService.isLoading" [ngClass]="workoutData?.is_active?'btn-danger':'btn-success'"
          (click)="action()">{{workoutData?.is_active?'Block':'Activate'}} <div class="spinner-border text-light"
            role="status" *ngIf="dataService.isLoading">
            <span class="visually-hidden">Loading...</span>
          </div>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Delete Modal -->
<div class="modal fade" data-bs-backdrop="static" id="dModal" tabindex="-1" aria-labelledby="dModal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <button id="closedModal" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body short-modal">
        <p><img class="modal-img img-fluid" src="../../../../assets/images/deleted.png" /></p>
        <h5 class="modal-title fs-5 mb-2">Delete Workout</h5>
        <p>Do you really want to <strong class="text-danger">Delete</strong> this
          Workout
          <strong>{{workoutData?.title}}</strong>?
        </p>
        <div class="assignment-list" *ngIf="assignmentList.length">
          <p><strong>Please Remove its Attachment with below Plans.</strong></p>
          <h6>Attached with Plans:</h6>
          <ul class="assignment">
            <li *ngFor="let item of assignmentList"><a target="_blank" [href]="'/plans/plan-detail/'+ item.id">
                {{item.title}}</a></li>
          </ul>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button *ngIf="!assignmentList.length" type="submit"
          class="btn w-100 d-flex justify-content-center align-items-center gap-2 m-auto"
          [disabled]="dataService.isLoading" [ngClass]="workoutData?.is_active?'btn-danger':'btn-success'"
          (click)="delete()">Delete <div class="spinner-border text-light" role="status" *ngIf="dataService.isLoading">
            <span class="visually-hidden">Loading...</span>
          </div>
        </button>
      </div>
    </div>
  </div>
</div>