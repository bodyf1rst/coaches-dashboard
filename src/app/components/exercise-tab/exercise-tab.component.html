<div class="exercise-card">
  <div class="exercise-thumbnail" (click)="toggleVideo()">
    <!-- Video with multiple source formats for compatibility -->
    <video *ngIf="!thumbnailError"
           #videoElement
           [poster]="getPosterFrame()" 
           [controls]="showVideo"
           (loadedmetadata)="onVideoLoaded($event)"
           (error)="onVideoError($event)"
           class="video-player"
           [style.display]="showVideo ? 'block' : 'block'"
           playsinline
           preload="metadata">
      <source [src]="item?.video_url" type="video/mp4">
      <source [src]="item?.video_url?.replace('.mp4', '.mov')" type="video/quicktime">
      Your browser does not support the video tag.
    </video>
    
    <!-- Gradient fallback if video fails -->
    <div *ngIf="thumbnailError" class="thumbnail-gradient">
      <i class="play-icon fas fa-play"></i>
    </div>
    
    <!-- Play overlay when not playing -->
    <div *ngIf="!showVideo && !thumbnailError" class="play-overlay">
      <i class="play-icon fas fa-play-circle"></i>
    </div>
    
    <!-- Duration badge -->
    <span class="duration-badge" *ngIf="!showVideo">{{item?.duration || '0:30'}}</span>
  </div>
  
  <div class="exercise-info">
    <h5 class="exercise-title" (click)="toggleDetails()" [class.expanded]="showDetails">
      {{item?.title}}
      <i class="fas fa-chevron-down expand-icon"></i>
    </h5>
    
    <div class="exercise-tags">
      <span class="tag category-tag">WORKOUT</span>
      <span class="tag type-tag" *ngFor="let tag of item?.tags || []">{{tag}}</span>
    </div>
    
    <div class="exercise-status">
      <span class="status-active" *ngIf="item?.is_active">Active</span>
      <span class="status-public">Public</span>
      <span class="transcription-badge" *ngIf="item?.transcription">
        <i class="fas fa-closed-captioning"></i> Transcribed
      </span>
    </div>
    
    <!-- Expandable transcription section -->
    <div class="exercise-details" *ngIf="showDetails">
      <div class="transcription-section" *ngIf="item?.transcription">
        <h6>Transcription:</h6>
        <p>{{item?.transcription || 'Transcription will appear here once the video is processed.'}}</p>
      </div>
      <div class="description-section">
        <h6>Description:</h6>
        <p>{{item?.description || 'No description available.'}}</p>
      </div>
    </div>
  </div>
</div>